import{d as J,a1 as K,l as $,c as ee,x as R,Q as te,y as ae,z as T,R as i,a8 as V,ce as h,cf as m,a3 as se,a6 as ie,a7 as oe,i as l,o as f,a as ne,m as E,g as v,w as y,B as re,b as x,ap as le,u as ce,e as ue,T as de,cg as g,E as pe,q as me,U as ge,L as we,n as X,t as A,bu as fe,_ as ye}from"./index--8fEwDZf.js";import{b as _e,a as he,_ as ve,c as xe}from"./AlertCircle-B22zGb_L.js";const Me={class:"notification-content","data-tauri-drag-region":"",style:{cursor:"move"}},Se={class:"btns"},I=50,c=10,ze=J({__name:"Notification",setup(We){ce(s=>({c587ecea:l(S)}));const{borderRadius:M,appOpacity:S,appTransform:k,oppositeBgColor:L}=ue(),{createWindow:D}=K();let B;const z=$(1),O=ee(()=>{const s=Math.floor(z.value/3600),e=Math.floor(z.value%3600/60),a=Math.floor(z.value%60);return`${s?`${s}:`:""}${e?`${e}:`:""}${a}`}),{notify:W}=de,Y=R({info:L?.value,loading:L?.value,success:"#67c23a",warning:"#e6a23c",danger:"#f56c6c"}),n=R({name:"运行中",currentMessage:{type:"info",message:"",time:""}});let b=!1;const U=()=>{h.getByLabel("main")?.show(),i.hide(),b=!0};let C;const d={lastX:0,lastY:0,lastMirrorPos:""};let r,p;const w=$(!0);te(w,async()=>{p&&clearTimeout(p);const s=B||h.getByLabel("floatWindow");if(w.value){if(k.value="none",M.value="20px",await i?.setSize(new m(300,40)),S.value=1,await V(),d.lastMirrorPos==="right"&&r){const e=await s?.outerPosition();await i?.setPosition(new g(r.width-300,e?.y||0))}}else{if(d.lastMirrorPos==="")return;const e=await i.outerPosition(),a=await i.innerSize();d.lastMirrorPos==="left"?(await i?.setPosition(new g(0,e.y)),k.value=`translateX(calc(-100% + ${c}px))`,M.value="0px 10px 10px 0px",p=setTimeout(()=>{i?.setSize(new m(c,a.height)),S.value=.5,clearTimeout(p)},1e3)):d.lastMirrorPos==="right"?(await i?.setPosition(new g(r.width-a.width,e.y)),k.value=`translateX(calc(100% - ${c}px))`,M.value="10px 0px 0px 10px",p=setTimeout(async()=>{await i?.setSize(new m(c,a.height)),await i.setPosition(new g(r.width-c,e.y)),S.value=.5,clearTimeout(p)},1e3)):(await i?.setPosition(new g(e.x,0)),k.value=`translateY(calc(-100% + ${c}px))`,M.value="0px 0px 10px 10px",p=setTimeout(async()=>{await i?.setSize(new m(a.width,c)),S.value=.5,clearTimeout(p)},1e3)),await s?.hide()}});const q=async(s,e)=>{const a=s??await i.innerSize(),{x:t,y:o}=e??await i.outerPosition();r=r??await T.getScreenSize();const{width:_}=r;let u="";return o<I?t<I?o<=t?u="top":u="left":_-a.width-t<I?o<=_-a.width-t?u="top":u="right":u="top":t<I?u="left":_-a.width-t<I&&(u="right"),u},H=async(s,e)=>{const{x:a,y:t}=await T.getMousePos();return a>=e.x&&a<=e.x+s.width&&t>=e.y&&t<=e.y+s.height},Q=async(s,e,a)=>{const t=B||h.getByLabel("floatWindow");if(!w.value){t?.hide();return}if(s===""){t?.hide();return}s==="top"?(await W.sendCustom({name:"borderRadius",message:"0 0 10px 10px"}),await t?.setSize(new m(e.width,c)),await t?.setPosition(new g(a.x,0))):s==="left"?(await W.sendCustom({name:"borderRadius",message:"0px 10px 10px 0px"}),await t?.setSize(new m(c,e.height)),await t?.setPosition(new g(0,a.y))):s==="right"&&(await W.sendCustom({name:"borderRadius",message:"10px 0px 0px 10px"}),await t?.setSize(new m(c,e.height)),r||(r=await T.getScreenSize()),await t?.setPosition(new g(r.width-c,a.y))),await t?.show()};let N,P;return ae(async()=>{r=await T.getScreenSize(),N=await W.listen(e=>{const{type:a,payload:t}=e.payload;if(a==="message")P&&clearInterval(P),n.currentMessage=t,t.type==="loading"&&(z.value=1,P=setInterval(()=>{z.value+=1},1e3));else if(a==="init")n.name=t.name,b=!1,n.currentMessage={type:"info",message:"",time:""};else if(a==="clear-message")n.currentMessage={type:"info",message:"",time:""};else if(a==="done")n.currentMessage={type:"info",message:"",time:""},i.hide(),b=!0;else if(a==="custom-message"){const{name:o}=t;o==="continue"&&(b=!1)}}),B=D("floatWindow","/floatWindow",{height:300,width:40,alwaysOnTop:!1}),await W.sendCustom({name:"opacity",message:"0.5"}),V(()=>{h.getByLabel("floatWindow")?.hide()});const s=setTimeout(()=>{h.getByLabel("floatWindow")?.hide(),clearTimeout(s)},500);i.setSize(new m(300,40)),M.value="20px",C=setInterval(async()=>{if(b||!await i.isVisible())return;const e=await T.getMousePos();if(e.x===d.lastX&&e.y===d.lastY)return;d.lastX=e.x,d.lastY=e.y;const a=await i.innerSize(),t=await i.outerPosition(),o=await q(a,t);d.lastMirrorPos=o,o===""?w.value=!0:!await H(a,t)?w.value=!1:w.value=!0,await Q(o,a,t)},200)}),se(()=>{P&&clearInterval(P),C&&clearInterval(C),N(),h.getByLabel("floatWindow")?.hide()}),(s,e)=>{const a=xe,t=_e,o=pe,_=he,u=ve,Z=fe,j=me,F=ge,G=we;return ie((f(),ne("div",Me,[E("div",{class:"content","data-tauri-drag-region":"",style:le([{cursor:"move"},{color:l(Y)[l(n).currentMessage.type||"info"]}])},[l(n).currentMessage.type==="loading"?(f(),v(a,{key:0,class:"icon","data-tauri-drag-region":"",style:{cursor:"move"}})):l(n).currentMessage.type==="success"?(f(),v(o,{key:1,class:"icon",size:"small","data-tauri-drag-region":"",style:{cursor:"move"}},{default:y(()=>[x(t,{"data-tauri-drag-region":""})]),_:1})):l(n).currentMessage.type==="warning"?(f(),v(o,{key:2,class:"icon",size:"small","data-tauri-drag-region":"",style:{cursor:"move"}},{default:y(()=>[x(_,{"data-tauri-drag-region":""})]),_:1})):l(n).currentMessage.type==="danger"?(f(),v(o,{key:3,class:"icon",size:"small","data-tauri-drag-region":"",style:{cursor:"move"}},{default:y(()=>[x(u,{"data-tauri-drag-region":""})]),_:1})):(f(),v(Z,{key:4,"data-tauri-drag-region":"",class:"icon",size:"small",style:{cursor:"move"}})),l(n).currentMessage.type==="loading"?(f(),v(j,{key:5,class:"icon",size:"small",type:"primary","data-tauri-drag-region":"",style:{cursor:"move"}},{default:y(()=>[X(A(l(O)),1)]),_:1})):re("",!0),x(F,{class:"message","data-tauri-drag-region":"",style:{cursor:"move"}},{default:y(()=>[X(A(l(n).currentMessage.message),1)]),_:1})],4),E("div",Se,[x(G,{class:"btn",size:"small",onClick:U,circle:""},{default:y(()=>[x(o,null,{default:y(()=>e[0]||(e[0]=[E("span",{"i-mdi-home-export-outline":""},null,-1)])),_:1})]),_:1})])],512)),[[oe,l(w)]])}}}),Te=ye(ze,[["__scopeId","data-v-5ffe9323"]]);export{Te as default};
